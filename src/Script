DROP VIEW VWLOGIN;
DROP TABLE TAREFA;
DROP TABLE USUARIO;
DROP TABLE TIPO_TAREFA;
DROP TABLE STATUS_TAREFA;


CREATE TABLE USUARIO(
   ID_USUARIO SERIAL,
   NOME_USUARIO VARCHAR(20) NOT NULL,
   EMAIL_USUARIO VARCHAR(30) NOT NULL,
   SENHA_A VARCHAR(100) NOT NULL,
   SENHA_B VARCHAR(100) NOT NULL,
   ATIVO VARCHAR(1) NOT NULL,
   CONSTRAINT PK_USUARIO PRIMARY KEY (ID_USUARIO),
   CONSTRAINT UK_NOME_USUARIO UNIQUE (NOME_USUARIO),
   CONSTRAINT UK_EMAIL_USUARIO UNIQUE (EMAIL_USUARIO)
);

CREATE OR REPLACE VIEW VWLOGIN 
AS 
SELECT 
   NOME_USUARIO,
   SENHA_A,
   SENHA_B
FROM 
   USUARIO;

CREATE TABLE TIPO_TAREFA(
   ID_TIPO_TAREFA SERIAL,
   DESC_TIPO_TAREFA VARCHAR(30) NOT NULL,
   CONSTRAINT PK_TIPO_TAREFA PRIMARY KEY(ID_TIPO_TAREFA),
   CONSTRAINT UK_TIPO_TAREFA UNIQUE (DESC_TIPO_TAREFA)
);

CREATE TABLE STATUS_TAREFA(
   ID_STATUS_TAREFA SERIAL,
   DESC_STATUS_TAREFA VARCHAR(30) NOT NULL,
   CONSTRAINT PK_STATUS_TAREFA PRIMARY KEY(ID_STATUS_TAREFA),
   CONSTRAINT UK_STATUS_TAREFA UNIQUE (DESC_STATUS_TAREFA)
);


CREATE TABLE TAREFA(
   ID_TAREFA SERIAL,
   ID_TIPO_TAREFA INTEGER NOT NULL,
   ID_USUARIO INTEGER NOT NULL,
   ID_STATUS_TAREFA INTEGER NOT NULL, -- DEFINIR VALOR PADRÃO
   DESC_TAREFA VARCHAR(100) NOT NULL,
   REQUISITOS VARCHAR(500) NOT NULL,
   PRECO FLOAT NOT NULL,
   DATA_CADASTRO DATE NOT NULL,
   DATA_ENTREGA DATE NOT NULL,
   EXTIMATIVA_HORA INTEGER,
   CONSTRAINT FK_USUARIO FOREIGN KEY(ID_USUARIO) REFERENCES USUARIO(ID_USUARIO),
   CONSTRAINT FK_TIPO_TAREFA FOREIGN KEY(ID_TIPO_TAREFA) REFERENCES TIPO_TAREFA(ID_TIPO_TAREFA),
   CONSTRAINT FK_STATUS_TAREFA FOREIGN KEY(ID_STATUS_TAREFA) REFERENCES STATUS_TAREFA(ID_STATUS_TAREFA),
   CONSTRAINT PK_TAREFA PRIMARY KEY(ID_TAREFA)
);